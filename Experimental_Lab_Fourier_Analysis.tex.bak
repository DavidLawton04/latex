\documentclass{article}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{xfrac}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{tikz}
\usepackage{fullpage}
\usepackage{hyperref}
\usepackage{mathalpha}

\title{Fourier Analysis: A Study of the Fourier Transforms of Various Natural Waves.}
\author{David Lawton}
\date{10th Feb. 2024}

\begin{document}

\maketitle
\vfill
\tableofcontents

\newpage
\section{Abstract}
This experiment examined various characteristics of waves using the fast or discrete Fourier Transform. The techniques used, as well as the theory behind them is explained below. We made observations on optimisation of sampling, verified several expected results and viewed how the form of a particular wave changed in a less stable medium than the usual electric one, as well as how the FFT of that wave changed with it.
\section{Introduction}
The objective of this experiment is to measure and analyse various waves using the Fast Fourier Transform (FFT). The waves are generated by a function generator, a microphone and speaker, and a tuning fork. In some cases, explanations are included to explain variation from the theoretical model.\\
\subsection{Theory of Fourier Analysis}
To explain and research the many natural \textit{approximately} periodic physical systems, we often use the Fourier Transform. This is a mathematical transform, on a periodic function, which switches from the original domain to the frequency domain. A function is periodic if it obeys
\begin{equation}
f(x+L)=f(x),
\end{equation}
where the minimum value of $L$, $T$, is called the \textit{fundamental period} of the function, with the corresponding $\frac{1}{T}$ being the \textit{fundamental frequency}.\\
\indent The \textit{Fourier series} of any periodic function is a way of writing that functions as the sum of many sine and cosine waves of different amplitudes and frequencies.
\begin{equation}
f(x)=a_0+\sum_{n=1}^{\infty}\left[a_{n}\mathrm{cos}\left(\frac{2\pi nx}{L}\right)+b_{n}\mathrm{sin}\left(\frac{2\pi nx}{L}\right)\right]
\label{eq: FourierSeries}
\end{equation}
with the \textit{Fourier coefficients}, $a_m, b_m, a_0$ being calculated by integrating across the period of the function.
\begin{equation}
a_0 = \frac{1}{T}\int_0^Tf(t)\mathrm{d}t
\label{eq: a0}
\end{equation}
\begin{equation}
a_m = \frac{1}{T}\int_0^Tf(t)\mathrm{cos}\left(\frac{2 \pi m t}{T}\right)\mathrm{d}t,~~~b_m = \frac{1}{T}\int_0^Tf(t)\mathrm{sin}\left(\frac{2 \pi m t}{T}\right)\mathrm{d}t
\label{eq:anbncoeffs}
\end{equation}
The coefficients, $a_m, b_m$ can be seen as a weighting of a certain frequency wave, and the actual function being a kind of weighted sum of the waves.
\indent Functions being even or odd can make the calculation of the Fourier series of the functions much easier. An even function is defined as obeying
\begin{equation}
f(x)=f(-x),
\end{equation}
an odd function is defined as obeying
\begin{equation}
f(x)=-f(-x).
\end{equation}
An even function is made up only of cosine waves ($b_m = 0 \text{ for all } m$) and an odd function is made up only of sine waves ($a_m = 0 \text{ for all } m$).\\
\indent The \textit{Fourier Transform} of a continuous function switches to the frequency domain by the following integral.
\begin{equation}
F( \nu )=\int_{-\infty}^{\infty}f(t)\mathrm{e}^{-\mathrm{i}2\pi \nu t}\mathrm{d}t
\label{eq: FT}
\end{equation}
However, this obviously does not work for a set of discrete points. This requires a discrete analogue, the Discrete Fourier Transform,
\begin{equation}
F_n = \sum_{n=0}^{N-1}f_m \cdot  e^{-\mathrm{i} 2\pi n \frac{\nu}{N}}
\label{eq: DFT}
\end{equation}
the discrete variables $m,n$ replace the continuous variables t, $\nu$.
\subsection{Uses of Fourier Analysis}
Fourier Analysis is a tool which is instrumental in the analysis of natural phenomena, in all areas of STEM from astrophysics to electrical engineering. The Fourier Transform transform allows anyone analysing a periodic function to gain essential insights into its characteristics, as can be seen below.
\subsection{Wave Types}
\begin{enumerate}
\item Sinusoidal wave.
\begin{equation}
f(t)=sin(\omega t +\phi), ~~\omega = 2\pi\nu
\end{equation}
\item Square wave.
\begin{equation}
f(t)=
	\begin{cases}
			-L, & \text{if } -L \leq t \leq 0 \\
			L, & \text{if } 0 \leq t \leq L
	\end{cases}, \quad
f(t)=f(t+2L)
\end{equation}
\item Triangular wave.
\begin{equation}
f(t)=
	\begin{cases}
			t + \frac{L}{2}, & \text{if } -L\leq t \leq 0 \\
			-t + \frac{L}{2}, & \text{if } 0\leq t\leq L\\
	\end{cases},\quad
f(t)=f(t+2L)	
\end{equation}
\item Sawtooth wave.
\begin{equation}
f(t)=\frac{t}{2},\quad f(t)=f(t+2L)
\end{equation}
\end{enumerate}
\subsection{Aliasing}
A prevalent source of error and interest in Fourier Analysis, and the observation of periodic motion in general, is aliasing. Aliasing is defined as the appearance of a wave as a lower frequency wave due to an insufficient sampling rate. For a sample to accurately depict an observed wave, it must take samples at a frequency at least twice that of the wave. For a given sampling rate the Nyquist frequency is defined as
\begin{equation}
f_{\text{Nyquist}} = \frac{1}{2}f_{\text{Sampling}}
\end{equation}
It is the frequency at which the observed wave cannot be reconstructed from the sample. To illustrate, I shall use a graph I produced for a previous computational experiment on the Discrete Fourier Transform.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.9\textwidth]{/home/dj-lawton/Documents/Dad_Code/cos_3_t 64 1.pdf}
\caption{\label{fig:DFTeg}Illustration of aliasing due to insufficient sampling rate. Notice the difference between the high frequency observed wave, and low frequency `wavegroup' produced}
\end{center}
\end{figure}
\section{Methodology}
\subsection{Setup and Generated Waves}
The procedure for this experiment involved several pieces of experimental equipment. We began the setup by opening the program for receiving and analysing the input, and turning on the sensor, which is plugged into the PC. Then we attach the function generator to the voltage inputs in the sensor, and configure the program to show the correct input, at appropriate ranges. We then selected the option to display the Fast Fourier Transform of the input on a second display with the frequency domain on the x-axis.\\
\indent Given a purely periodic function, increasing the sampling rate makes the peaks sharper and valleys deeper in the frequency domain, for example when sampling a Sine wave, of one second period, at a high frequency it returns a single high peak with the majority of other values going to approx. zero.\\
\begin{figure}[H]
\begin{center}
\begin{tabular}{cc}
\includegraphics[width=0.5\textwidth]{/home/dj-lawton/Downloads/Graph1.pdf} & \includegraphics[width=0.5\textwidth]{/home/dj-lawton/.wine/drive_c/users/dj-lawton/Documents/OriginLab/User Files/50HzSine50msSample.pdf}\\
(A) Time domain & (B) Frequency domain\\
\end{tabular}
\caption{\label{fig:SineWaveFFT}An illustration of the Fast Fourier Transform of a generated sine wave of constant amplitude and frequency of approx. 1Hz.}
\end{center}
\end{figure}
While not visible from the graph, from the data, it can also be seen that only odd harmonics are present, as slight increases in amplitude at the odd multiple of the frequency indicate. While the data doesn't indicate a true spike at 3 Hz, it does indicate notable increases at 7 Hz, 11 Hz and 13 Hz. The harmonics are due to a lack of `purity' in the generated wave, they are all odd in this case because the generator only uses odd multiples in the function generation.\\
\indent We then generated several waves at various frequencies. For sinusoidal, square, triangular and sawtooth waves, they approximately follow the functions outlined in the introduction.\\
\subsection{Sound Waves}
The next section involves testing sound waves	 using a microphone connected to the same inputs which the function generator was connected to previously, and various methods of sound generation. The microphone is switched to the correct reception mode.\\
\indent Our initial sound generated was a square wave generated by a speaker attached to the function generator, this creates a square wave picked up by the microphone through the air.\\
\indent Following this we tested the upper and lower frequency thresholds of human hearing for different people and of the microphone. The hearing thresholds was done by keeping the ear of the listener a set distance from the speaker at a relatively high volume, and varying the frequency of the output, first higher until not heard then lower until not heard. The microphone thresholds were tested similarly with the definition of `hearing' being the values for which the frequency of the produced wave is at a minimum twice the amplitude of the next highest peak.\\
\indent Our next step was to analyse the waves and frequency spectrums of the vowel sounds. This was done by speaking into the microphone over the period which it receives input for.\\
\subsection{Aliasing}
The next section focuses on showing the effect of aliasing, returning to the wave generator set up. We set a constant sampling rate of one sample per $10\mu$s, and analysed the frequency spectrum as the frequency of the generated wave increases, until the input frequency is higher than the observable frequency range. Then observing what happens after.
\subsection{Square Wave Pulse}
To follow, we analysed the frequency spectrum of a square pulse. This pulse was produced by setting a two second input time, setting the generator to DC, and disconnecting the generator from the input. Then, the disconnected generator output is touched on the sensor input for approx. one second of the input time. \\
\section{Results}
The first notable result is the effect of lowering sample time on the accuracy of the FFT. By looking at the data, in both table and graph form, the FFT of a 1Hz sinusoidal wave was analysed. We presumed that taking the most simple form would give the clearest result.\\
\vspace{3mm}\\
\begin{center}
\begin{tabular}{|c|c|c|c|}
 \hline 
 \multicolumn{2}{|c|}{1ms Sampling} & \multicolumn{2}{|c|}{50ms Sampling} \\ 
 \hline 
 Frequency (0.2) & Voltage (0.02) & Frequency (0.1) & Voltage (0.02)\\ 
 \hline 
 0 & 0.72 & 0 & 0.89 \\ 
 \hline 
 0.1 & 0.73 & 0.01 & 0.98 \\ 
 \hline 
 0.2 & 0.2 & 0.2 & 0.48 \\ 
 \hline 
 0.4 & 0.05 & 0.2 & 0.15 \\ 
 \hline 
 0.5 & 0.08 & 0.3 & 0.09 \\ 
 \hline 
 0.6 & 0.15 & 0.4 & 0.08 \\ 
 \hline 
 0.7 & 0.99 & 0.5 &  0.09\\ 
 \hline 
 0.9 & 3.85 & 0.5 & 0.11 \\ 
 \hline 
 1.0 & 5.08 & 0.6 & 0.11 \\ 
 \hline 
 1.1 & 4.31 & 0.7 & 0.1 \\ 
 \hline 
 1.2 & 1.47 & 0.8 & 0.98 \\ 
 \hline 
 1.3 & 0.19 & 0.9 & 3.5 \\ 
 \hline 
 1.5 & 0.13 & 0.9 & 6.28 \\ 
 \hline 
 1.6 & 0.1 & 1.0 & 6.77 \\ 
 \hline 
 1.7 & 0.08 & 1.1 & 4.36 \\ 
 \hline 
 1.8 & 0.08 & 1.2 & 1.61 \\ 
 \hline 
 2.0 & 0.07 & 1.3 & 0.25 \\ 
 \hline 
 2.1 & 0.06 & 1.3 & 0.14 \\ 
 \hline 
\end{tabular}  \\
\end{center}
\vspace{3mm}
As is obvious from the representative data, the higher sampling rate returns approximately 7 points of data per Hz in the frequency spectrum, while the lower sampling rate returned 13 points of data per Hz. This larger margin of error in the higher sampling rate of 1ms results from a larger spread of data and perhaps some computational error. Each sample returns a FFT up to the nyquist frequency, ie. the frequency up to which it can accurately reconstruct the wave, this means that the spread of points larger, giving a less accurate result for comparatively small frequencies.\\
\begin{figure}[H]
\begin{center}
\begin{tabular}{cc}
\includegraphics[width=0.5\textwidth]{/home/dj-lawton/.wine/drive_c/users/dj-lawton/Documents/OriginLab/User Files/1HzSine1msSample.pdf} & \includegraphics[width=0.5\textwidth]{/home/dj-lawton/.wine/drive_c/users/dj-lawton/Documents/OriginLab/User Files/50HzSine50msSample.pdf}\\
\end{tabular}
\caption{\label{fig:SineWaveFFT}Comparison of FFTs of 1Hz sinusoidal wave at 1ms sample rate vs 50ms sample rate}
\end{center}
\end{figure}
\indent Our next result is related to square waves. When observing the data for the square wave FFT, a pattern of only odd harmonics appearing is evident and is most easily observable in graphic representation.
\begin{figure}[H]
\begin{flushleft}
\begin{tabular}{cc}
\includegraphics[width=0.5\textwidth]{/home/dj-lawton/Documents/SF Lab Plots/FAExpLab/SquareWaveOddHarmonics.pdf} & \includegraphics[width=0.5\textwidth]{/home/dj-lawton/Documents/SF Lab Plots/FAExpLab/SquareWave.pdf}\\
\end{tabular}
\caption{\label{fig:Squarewave} Frequency and time domains of a generated square wave}
\end{flushleft}
\end{figure}
The slight offset down from the expected odd numbered integer values for the 1Hz square wave is due to scale error in the generator such that the 1Hz choice returned a wave of slightly lower frequency than expected.\\
\indent The third result stems from the generation of sound waves in air. When observing the received wave, some clear distortion of the generated wave has occurred.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.5\textwidth]{/home/dj-lawton/Documents/SF Lab Plots/FAExpLab/SoundSquareForFA.pdf}
\caption{\label{fig:SoundSquare}The received square wave, distorted from the original generated wave similar in form to figure~\ref{fig:Squarewave}}
\end{center}
\end{figure} 
The distortion is also evident in the frequency spectrum. Instead of the relatively clean spectrum produced by the electrically transmitted square wave, the sound wave produces a messier output, with several even harmonics having significant contributions.
\begin{figure}[H]
\begin{center}
\begin{tabular}{cc}
\includegraphics[width=0.5\textwidth]{/home/dj-lawton/Documents/SF Lab Plots/FAExpLab/SoundSquareFFT.pdf} & \includegraphics[width=0.5\textwidth]{/home/dj-lawton/Documents/SF Lab Plots/FAExpLab/SquareWaveOddHarmonics.pdf}\\
\end{tabular}
\caption{\label{fig:FFTComp} Comparison of frequency spectrum of a largely distorted square wave (left) versus that of one with very little distortion (right).}
\end{center}
\end{figure}
\indent The next section, in which results were found, was that on aliasing. To show the aliasing of a wave, as described earlier, we used a sine wave and increased the frequency of the input until the frequency surpassed the Nyquist frequency. For a sampling rate of once per $50\mu s$, ie. a sampling frequency of 20 kHz, the Nyquist frequency is 10 kHz. Thus for an 11 kHz input sinusoidal wave, the following frequency spectrum is produced.
\begin{figure}[H]
\begin{center}
\includegraphics[width=0.8\textwidth]{/home/dj-lawton/Documents/SF Lab Plots/FAExpLab/AliasedWave.pdf}
\caption{\label{fig: AliasedWave} Aliased frequency spectrum of a 11 kHz sine wave.}
\end{center}
\end{figure}
As is clearly visible, the frequency of 11 kHz, exceeding the maximum perceivable frequency of 10 kHz, appears under the alias of a 8 kHz frequency.
\section{Conclusion}
The first conclusion we can make, from the first result, is that for each periodic input, for this computer program at least, there exists at least one optimal sampling rate, at which the wave is most accurately transformed to the frequency, and so most accurately reconstructable. This, if true, likely could be used in the improved efficiency of systems which use FFT often.\\
\indent The next conclusion that can made follows from the second result. It is clear that, in the FFT of the square wave, only odd harmonics of the frequency of the square wave. That is to say for the lth prevalent peak $f_{l}$,
\begin{equation}
f_l=(2l+1)f_0,~\text{ where } f_0 \text{ is the frequency of the inputted square wave.}
\end{equation}
This agrees with the expected result, which is due to the sharp change of voltage at the discontinuities of square waves.\\
\indent We can also conclude that, from the third result, distortion of a waveform results in the inclusion of even harmonics, and the `spreading out' of the frequency spectrum of the wave. Perhaps if a relation between the spreading of the spectrum and the level of distortion could be found this would allow the original generated square wave to be reconstructed.\\
\indent Additionally the results on aliasing
\section{References}
\begin{enumerate}
\item Weisstein, Eric W.	 "Discrete Fourier Transform." From MathWorld--A Wolfram Web Resource.\\ 
https://mathworld.wolfram.com/DiscreteFourierTransform.html 
\item Hecht, Eugene. ``Optics"
\item Feynman, Richard P., Leighton, Robert B., Sands, Matthew L.,  ``The Feynman Lectures on Physics'' - Addison Wesley, 1989
\item Lawton, David - `Fourier Analysis: A Study of the Computation of Fourier Series and Transforms of Various Functions.' - TCD School of Physics, 2023
\end{enumerate}
\end{document}
